# PicoCTF [Login](https://play.picoctf.org/practice/challenge/200)
### Initial impression

A barebones html Login page that uses Javascript alerts to show results from the user's input.

<img width="299" height="328" alt="login" src="https://github.com/user-attachments/assets/59c53a5e-3692-44fe-bbd3-6fe7e5f5c6ea" />


### Findings:
#### Username Enumeration Vulnerability:
The error message changes to ```password incorrect``` instead of ```username incorrect``` when ```admin``` is used in the username field. This leads me to believe that admin is a username that exists on this website.

#### Client side Javascript:
The following code can be accessed in a user's browser using the inspect tool:

```js
(async () => {
    await new Promise((e => window.addEventListener("load", e))),
    document.querySelector("form").addEventListener("submit", (e => {
        e.preventDefault();
        const r = {
            u: "input[name=username]",
            p: "input[name=password]"
        }
          , t = {};
        for (const e in r)
            t[e] = btoa(document.querySelector(r[e]).value).replace(/=/g, "");
        return "YWRtaW4" !== t.u ? alert("Incorrect Username") : "cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ" !== t.p ? alert("Incorrect Password") : void alert(`Correct Password! Your flag is ${atob(t.p)}.`)
    }
    ))
}
)();
```
This appears to be the logic that reads the username and password from the html field, stores them in an object ```r``` and compares those values against an encoded string.

#### Solution:
```js
for (const e in r)
            t[e] = btoa(document.querySelector(r[e]).value).replace(/=/g, "");
```
Encodes all characters in ```r``` with base64 using the ```btoa()``` method. Then strips all ```=``` signs with the ```.replace``` string method (presumably to obfuscate it's encoding). This means that the encoded values found in line:
```js
return "YWRtaW4" !== t.u ? alert("Incorrect Username") : "cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ" !== t.p ? alert("Incorrect Password") : void alert(`Correct Password! Your flag is ${atob(t.p)}.`)
```
are the hardcoded base64 username and password. Sure enough, ```YWRtaW4``` decodes from base64 to ```admin```. The password decodes to the flag, solving the challenge.
